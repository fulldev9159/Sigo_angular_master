<div class="row">
  <ng-container *ngIf="form">
    <ng-container *ngIf="form.get('servicios') as servicios">
      <div class="col-xs-12 col-md-12">
        <div class="card">
          <div class=" grid">
            <table style="width:100%">
              <thead>
                <tr>
                  <th></th>
                  <th>Cod.</th>
                  <th>Descripci√≥n</th>
                  <!-- <th>Servicio</th> -->
                  <th style="text-align: right">Cant. informe av.</th>
                  <th style="text-align: right">Cant. Pagada</th>
                  <th style="text-align: right">Cant. a Enviar</th>
                  <th>Precio Un.</th>
                  <th>Total a pagar</th>
                </tr>
              </thead>
              <tbody>
                <ng-container *ngFor="let servicio of servicios.controls">
                  <tr>
                    <td class="label-table">
                      <input type="checkbox" [formControl]="servicio.get('selected')">
                    </td>
                    <td class="label-table">{{ servicio.get('numero_producto').value }}</td>
                    <td class="data-secundaria">
                      <ng-container *ngIf="servicio.get('adicional_aceptacion_estado').value!=='ORIGINAL'">
                        <p-tag styleClass="pendiente" value="Adicional" severity="warning">
                        </p-tag>
                      </ng-container>
                      {{ servicio.get('descripcion').value |titlecase}}
                    </td>
                    <!-- <tdc>{{ servicio.get('adicional_aceptacion_estado').value!=='ORIGINAL'?'ADICIONAL':'ORIGINAL' }}</td> -->
                    <td style="text-align: right" class="data-secundaria">{{ servicio.get('cantidad_total').value }}
                    </td>
                    <td style="text-align: right" class="data-secundaria">{{ servicio.get('cantidad_total').value -
                      servicio.get('cantidad_max_a_enviar').value }}</td>
                    <td>
                      <input [formControl]="servicio.get('cantidad_a_enviar')" type="number">
                      <zwc-input-alert [control]="servicio.get('cantidad_a_enviar')"></zwc-input-alert>

                    </td>
                    <td class="data-secundaria">{{ +servicio.get('precio_unitario').value| currency : 'CLP' :
                      '$':'.0-2':'es-CL' }}</td>
                    <td class="data-secundaria">{{ +servicio.get('cantidad_a_enviar').value *
                      +servicio.get('precio_unitario').value| currency : 'CLP' : '$':'.0-2':'es-CL' }}</td>
                  </tr>

                  <ng-container *ngIf="form.get('unidades_obra') as unidadesObra">
                    <ng-container *ngFor="let uo of unidadesObra.controls">
                      <tr *ngIf="uo.get('servicio_numero_producto').value===servicio.get('numero_producto').value">
                        <td style="
                        padding-left: 22px !important;">
                          <input type="checkbox" [formControl]="uo.get('selected')">
                        </td>
                        <td class="label-table" style="
                        padding-left: 22px !important;">{{ uo.get('uo_codigo').value }}</td>
                        <td class="data-secundaria">
                          <ng-container *ngIf="servicio.get('adicional_aceptacion_estado').value!=='ORIGINAL'">
                            <p-tag styleClass="pendiente" value="Adicional" severity="warning">
                            </p-tag>
                          </ng-container>
                          {{ uo.get('descripcion').value|titlecase }}
                        </td>
                        <!-- <td></td> -->
                        <td style="text-align: right" class="data-secundaria">{{ uo.get('cantidad_total').value }}</td>
                        <td style="text-align: right" class="data-secundaria">{{ uo.get('cantidad_total').value -
                          uo.get('cantidad_max_a_enviar').value }}</td>
                        <td>
                          <input [formControl]="uo.get('cantidad_a_enviar')" type="number">
                        </td>
                        <td class="data-secundaria">{{ +uo.get('precio_unitario').value| currency : 'CLP' :
                          '$':'.0-2':'es-CL' }}</td>
                        <td class="data-secundaria">{{+uo.get('cantidad_a_enviar').value *
                          +uo.get('precio_unitario').value| currency : 'CLP' : '$':'.0-2':'es-CL' }}</td>
                      </tr>
                    </ng-container>
                  </ng-container>
                </ng-container>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </ng-container>
  </ng-container>
</div>

<br>

<div class="row" id="table-totales">
  <div class="col-md-4 col-xs-12"></div>
  <div class="col-md-4 col-xs-12">
    <table style="width: 100%;">
      <tr>
        <td>Total Servicios</td>
        <td>{{totalServicios| currency : 'CLP' : '$':'.0-2':'es-CL'}}</td>
      </tr>
      <tr>
        <td>Total Unidades Obra</td>
        <td>{{totalUO| currency : 'CLP' : '$':'.0-2':'es-CL'}}</td>
      </tr>
    </table>
  </div>
  <div class="col-md-4 col-xs-12"></div>
</div>
<!-- 
<div class="row" id="table-totales">
  <div class="col-md-4 col-xs-12"></div>
  <div class="col-md-4 col-xs-12">
    <div class="card">
      Total a Pagar
      <span class="total-pagar"> {{totalServicios + totalUO| currency : 'CLP' : '$':'.0-2':'es-CL'}} </span>
    </div>
  </div>
  <div class="ccol-md-4 col-xs-12"></div>
</div> -->