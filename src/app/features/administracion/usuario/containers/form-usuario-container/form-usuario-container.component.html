<div class="container-fluid">
  <div class="row">
    <div class="col">
      <h1 class="mt-4">Usuario </h1>
      <span>formulario de ingreso</span>
    </div>
    <div class="col">
      <button pButton type="button" label="Volver" icon="pi pi-arrow-left"
        class="p-button-sm mt-5 float-right p-button-outlined" (click)="goBack()"></button>
    </div>
    <div class="col-12">
      <hr>
    </div>
  </div>

  <div class="card">
    <div class="card-body">
      <div class="row justify-content-center">
        <div class="col-12">
          <form [formGroup]="formUser">
            <div class="row justify-content-center">
              <div class="col-md-6 col-xs-12 ">
                <div id="guia-input">
                  <div class="row">
                    <div class="col-md-4 col-xs-12 ">
                      <label>* Usuario Guia:</label>
                    </div>
                    <div class="col-md-8 col-xs-12 ">
                      <input [formControl]="formControls.username" class="form-control" type="text" name="username">
                    </div>
                  </div>
                </div>
                <br>
                <div id="rut-input">
                  <div class="row">
                    <div class="col-md-4 col-xs-12 ">
                      <label>* Documento identidad:</label>
                    </div>
                    <div class="col-md-8 col-xs-12 ">
                      <input [formControl]="formControls.rut" class="form-control" type="text" name="rut">
                    </div>
                  </div>
                </div>
                <!-- <input id="documento-input" name="documento-input" formControlName="rut" maxlength="15" minlength="10" placeholder="xx.xxx.xxx-x" class="form-control" type="text">  -->
                <br>
                <div id="nombres-input">
                  <div class="row">
                    <div class="col-md-4 col-xs-12 ">
                      <label>* Nombres:</label>
                    </div>
                    <div class="col-md-8 col-xs-12 ">
                      <input [formControl]="formControls.nombres" class="form-control" type="text" name="nombres">
                    </div>
                  </div>
                </div>
                <br>
                <div id="apellidos-input">
                  <div class="row">
                    <div class="col-md-4 col-xs-12 ">
                      <label>* Apellidos:</label>
                    </div>
                    <div class="col-md-8 col-xs-12 ">
                      <input [formControl]="formControls.apellidos" class="form-control" type="text" name="apellidos">
                    </div>
                  </div>
                </div>
                <br>
                <div id="email-input">
                  <div class="row">
                    <div class="col-md-4 col-xs-12 ">
                      <label>* Email:</label>
                    </div>
                    <div class="col-md-8 col-xs-12 ">
                      <input [formControl]="formControls.email" class="form-control" type="text" name="email">
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-4 col-xs-12">
                    <label for="">Celular</label>
                  </div>
                  <div class="col-md-8 col-xs-12" id="celular-input">
                    <p-inputMask id="celular-input" name="celular-input" formControlName="celular"
                      styleClass="form-control" mask="(99) 9 9999 9999" unmask="true">
                    </p-inputMask>
                  </div>
                </div>
              </div>
              <div class="col-md-6 col-xs-12">
                <div class="row align-items-center" style="height: 100%;">
                  <div class="col-12">
                    <div class="tipoEmpresa">
                      <label for="">Empresa</label>
                      <div class="row" style="margin-left: 19%;">
                        <div class="col-xs-12 col-md-5">
                          <div class="p-field-radiobutton" id="movistar-radio-input">
                            <p-radioButton id="movistar" name="provider" formControlName="provider" value="movistar">
                            </p-radioButton>
                            <label for="movistar">Movistar</label>
                          </div>
                        </div>
                        <div class="col-xs-12 col-md-7">
                          <div class="p-field-radiobutton" id="contratista-radio-input">
                            <p-radioButton id="proveedor" name="provider" formControlName="provider"
                              value="contratista"></p-radioButton>
                            <label for="proveedor">Contratista</label>
                          </div>
                        </div>
                      </div>
                    </div>
                    <br>
                    <div id="proveedor-select">
                      <zwc-pdropdown [control]="formControls.proveedor_id" Label="* Proveedor"
                        dropdown_id="proveedor-select-dropdown" [data]="proveedores4createUser$|async"
                        Pplaceholder="Seleccione proveedor" [loading]="false" optionLabel="nombre" optionValue="id">
                      </zwc-pdropdown>
                    </div>
                    <br>
                    <div id="area-select">
                      <zwc-pdropdown [control]="formControls.area_id" Label="* Gerencia"
                        dropdown_id="area-select-dropdown" [data]="areas4createUser$|async"
                        Pplaceholder="Seleccione proveedor" [loading]="false" optionLabel="nombre" optionValue="id">
                      </zwc-pdropdown>
                    </div>

                  </div>
                </div>

              </div>
            </div>
            <div class="row">
              <div class="col-12">
                <hr>
              </div>
            </div>
            <div class="row">
              <div class="col-md-6 col-xs-12">
                <div id="guia-subgrupo-select">
                  <zwc-pdropdown [control]="formControls.guia_subgrupo_id" Label="* Guia Subgrupo"
                    dropdown_id="guia-subgrupo-select-dropdown" [data]="guiasSubgrupo$|async"
                    Pplaceholder="Seleccione subgrupo" [loading]="false" optionLabel="descripcion" optionValue="id">
                  </zwc-pdropdown>
                </div>
                <br>
                <p-checkbox [formControl]="formControls.delegated_auth" label="Autenticar en GUIA" value="true">
                </p-checkbox>
                <ng-container *ngIf="formControls.delegated_auth.value.length === 0">
                  <br>
                  <div class="row">
                    <div class="col-12" id="nombre-perfil-input">
                      <span class="p-float-label field">
                        <input type="{{ showPassword ? 'text' : 'password' }}" pInputText name="nombre"
                          class="p-inputtext-sm" [formControl]="formControls.password" />
                        <label for="nombre">{{ usuario_id === null ? 'Password': 'Nueva Password' }}</label>
                        <zwc-input-alert [control]="formControls.password"> </zwc-input-alert>
                      </span>
                    </div>
                  </div>
                  <ng-container *ngIf="showPassword">
                    <a style="cursor: pointer" (click)="showPassword = false">Ocultar contraseña</a>
                  </ng-container>
                  <ng-container *ngIf="!showPassword">
                    <a style="cursor: pointer" (click)="showPassword = true">Mostrar contraseña</a>
                  </ng-container>
                </ng-container>
              </div>
            </div>
            <div class="row">
              <div class="col-12">
                <hr>
              </div>
            </div>
            <div class="row justify-content-center">
              <div class="col-md-6 col-xs-12">
                <label for="">Contratos con los que puede trabajar</label>
                <div id="contratos-select">
                  <p-multiSelect id="contratos_marco_multi" name="contratos_marco_multi" [style]="{'width':'100%'}"
                    placeholder="Seleccionar contratos..." [options]="posiblesContractosUser$|async"
                    formControlName="contratos_marco" optionLabel="nombre" optionValue="id" [virtualScroll]="true"
                    itemSize="30">
                  </p-multiSelect>
                  <div
                    *ngIf="formControls.contratos_marco.invalid && (formControls.contratos_marco.dirty || formControls.contratos_marco.touched)">
                    <p-message severity="error" text="Este campo es requerido"></p-message>
                  </div>
                </div>

                <br>
                <!-- <label>Adjuntar Firma</label>
                <p-fileUpload chooseLabel="Agregar documento" name="demo[]" #filesform auto="true" (uploadHandler)="onUpload($event)" (onRemove)="onDeleteFile($event)" customUpload="true" accept=".docx,.doc,.gif,.json,.jpeg,.pjpeg,.png,.txt,.pdf,.gzip,.zip,.rar,.7zip,zip,.dwg,.csv,.xls,.ppt,.pptx,text/plain" maxFileSize="50000000">
                </p-fileUpload>

                <label style="color: #464646;font-weight: 400;">
                  <strong style="margin-left: 7px;margin-right: 7px;">Extensiones permitidas:</strong>
                  <span style="word-spacing: 5px">.docx .doc .gif .json .jpeg .pjpeg .png .txt .pdf .gzip .zip .rar .7zip zip .dwg .csv .xls .ppt .pptx </span>
                </label> -->
              </div>
              <!-- <div class="col-md-6 col-xs-12">
                <app-select [control]="formControls.superior" label="Superior directo">
                  <ng-container options>
                    <option value="null" selected disabled>Seleccione persona</option>
                    <option value="null">No posee superior directo</option>
                    <ng-container *ngFor="let superior of samecompanyusers$ | async">
                      <option [value]="superior.id">
                        {{ superior.nombres }} {{ superior.apellidos }}
                      </option>
                    </ng-container>
                  </ng-container>
                </app-select>
              </div> -->
            </div>
            <div class="row">
              <div class="col-12">
                <hr>
              </div>
            </div>
            <!-- <div class="row justify-content-center">
              <div class="col-3"></div>
              <div class="col-5" style="border: solid 1px #ced4da;
              padding: 33px;">
                <h5>Perfil</h5>
                <p-multiSelect id="perfiles" [options]="perfiles" [style]="{'width':'100%'}" [group]="true" defaultLabel="Seleccione los perfiles del usuario" scrollHeight="300px" display="chip" formControlName="perfiles">
                  <ng-template let-group pTemplate="group">
                    <div class="p-d-flex p-ai-center">
                      <span>{{group.label}}</span>
                    </div>
                  </ng-template>
                </p-multiSelect>
                <div *ngIf="formControls.perfiles.invalid && (formControls.perfiles.dirty || formControls.perfiles.touched)">
                  <p-message severity="error" text="Este campo es requerido"></p-message>
                </div>
                <div class="row justify-content-center" *ngFor="let perfil of profiles$|async">
                  <div class="col-1">
                    <p-checkbox name="group1" value="{{perfil.id}}" formControlName="perfiles"></p-checkbox>
                  </div>
                  <div class="col-8"> <label for="ny">{{perfil.nombre}}</label></div>
                  <div class="col-2" style="text-align: start"> <button (click)="showPermisos(perfil.id)" style="border: 1px solid;">permisos</button></div>
                </div>
              </div>
              <div class="col-3"></div>
            </div> -->
            <div class="col-xs-12 offset-md-7 col-md-5 text-right mb-4">
              <button id="submit-user" (click)="save()" type="submit" [disabled]="!formUser.valid"
                class="btn btn-primary"><em class="pi pi-save mr-1"></em>Guardar</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>